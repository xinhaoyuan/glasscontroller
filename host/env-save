#!/bin/bash

lastn=""
lastv=""
env |  while read line; do
    if [[ $line =~ ^[^=]+= ]]; then
        if [ -n "$lastn" ]; then
            echo "export $lastn="$(printf '%q' "$lastv")
        fi
        lastn=`expr "$line" : "^\([^=]*\)="`
        lastv=`expr "$line" : "^[^=]*=\(.*\)$"`
    else
        lastv="$lastv"$'\n'"$line"
    fi
done
